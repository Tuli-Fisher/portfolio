(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}})();const p=document.querySelector("#lastReloadTime"),M=300*1e3,q=180*1e3,k=60*1e3;function C(e,t){localStorage.setItem(e,JSON.stringify({currentTime:Date.now(),data:t}))}function H(e,t){const r=localStorage.getItem(e);if(r){const n=JSON.parse(r);if(n.currentTime+t>Date.now())return console.log(`loading ${e} from cache`),n;localStorage.removeItem(e)}return null}async function O(e,t=!1){let r;const n=H("users",M);if(n===null||t)try{console.log("fetching user data");const o=await fetch(e);if(!o.ok)throw new Error(`${o.status} - ${o.statusText}`);r=await o.json(),p.innerHTML=`Last reload at: ${new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0})}`,C("users",r)}catch(o){console.error("Error loading user data:",o)}else r=n.data,p.innerHTML=`Last reload at: ${new Date(n.currentTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0})}`;return r}async function P(e,t,r=!1){let n;const o=e==="users"?M:e==="posts"?q:k,s=H(`${e}-${t}`,o);if(s===null||r)try{console.log(`fetching ${e} data`);const a=await fetch(`https://jsonplaceholder.typicode.com/${e}?${e}Id=${t}`);if(!a.ok)throw new Error(`${a.status} - ${a.statusText}`);const b=await a.json();p.innerHTML=`Last reloaded at: ${new Date().toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0})}`,C(`${e}-${t}`,b),n=b}catch(a){console.error(`Error loading blog ${e}:`,a)}else n=s.data,p.innerHTML=`Last reload at:${new Date(s.currentTime).toLocaleTimeString()}`;return n}const d=document.querySelector(".users-container"),c=document.querySelector(".posts-container"),S=document.querySelector("#backButton"),B=document.querySelector("#reload-button"),u=document.querySelector("#sort-select"),U=document.querySelector("#search-button"),h=document.querySelector("#search-input"),T=document.querySelector("#loadMore-span");let A=[],l,v,g=3,y=10,L=10,i;async function m(e=!1){let t=await O("https://jsonplaceholder.typicode.com/users",e);if(v="usersPage",i=t.length,t=t.slice(0,g),T.innerText=`loaded ${g} / ${i}`,Array.isArray(t)&&t.length===0){f("error loading users");return}h.value.trim()!==""&&(t=D(t)),t=F(t),x(t)}async function $(e,t,r=!1){let n=await P("posts",e,r);if(Array.isArray(n)&&n.length===0){f("error loading posts");return}v="postsPage",i=n.length,n=n.slice(0,y),T.innerText=`loaded ${y} of ${i}`,h.value.trim()!==""&&(n=D(n)),j(n,t)}async function E(e,t=!1){let r=await P("comments",e,t);if(Array.isArray(r)&&r.length===0){f("error loading comments");return}v="commentsPage",i=r.length,r=r.slice(0,L),T.innerText=`loaded ${L} of ${i}`,h.value.trim()!==""&&(r=D(r)),I(e,r)}async function x(e){if(l=t=>m(t),!e){f("error loading users");return}Array.isArray(e)||(e=[e]),S.classList.add("hide"),u.classList.remove("hide"),d.classList.remove("hide"),c.classList.add("hide"),d.innerHTML="",e.forEach(t=>{const r=document.createElement("div");r.classList.add("user-card"),r.innerHTML=`
            <h2>${t.name}</h2>
            <h4>${t.username}</h4>
            <h4>${t.email}</h4>`,r.addEventListener("click",()=>{A.push(()=>m()),$(t.id,t.name)}),d.appendChild(r)})}async function j(e,t){if(l=r=>$(e,t,r),!e){f("error loading posts");return}Array.isArray(e)||(e=[e]),d.classList.add("hide"),u.classList.add("hide"),S.classList.remove("hide"),c.classList.remove("hide"),c.innerHTML=`<h1>Heres what ${t} has to say   `,e.forEach(r=>{const n=document.createElement("div");n.classList.add("post-card"),n.innerHTML=`
            <h2>${r.title}</h2>
            <p>${r.body}</p>`,n.addEventListener("click",()=>{A.push(()=>$(e,t)),E(r.id)}),c.appendChild(n)})}async function I(e,t){l=r=>E(e,t),Array.isArray(t)||(t=[t]),c.innerHTML=`<h1>Heres what people think about post ${e} -  `,t.forEach(r=>{const n=document.createElement("div");n.classList.add("post-card"),n.innerHTML=`
            <h2>${r.name}</h2>
            <h4>${r.email}</h4>
            <p>${r.body}</p>`,c.appendChild(n)})}S.addEventListener("click",()=>{A.pop()?.()});B.addEventListener("click",async()=>l(!0));u.addEventListener("change",async()=>l());U.addEventListener("click",async()=>l());document.querySelector("#clear-button").addEventListener("click",()=>{h.value=""});function f(e){d.innerHTML=`<h2 style="color:red;">${e}</h2>`}function F(e){if(!Array.isArray(e))return;const t=[...e];return u.value==="aToz"&&t.sort((r,n)=>r.name.localeCompare(n.name)),u.value==="zToa"&&t.sort((r,n)=>n.name.localeCompare(r.name)),t}function D(e){const t=h.value.toLowerCase();return e.filter(n=>n.name?n.name.toLowerCase().includes(t):n.body.toLowerCase().includes(t))}T.addEventListener("click",()=>{switch(v){case"usersPage":g=w(g,3),m();break;case"postsPage":y=w(y,10),$();break;case"commentsPage":L=w(L,10),E();break}});function w(e,t){if(!(e>=i))return e+3<=i?e+=t:e+=i-e,e}document.getElementById("home").addEventListener("click",()=>{m()});m();
